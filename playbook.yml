---
- hosts: all

  pre_tasks:
    - name: Load Playbook config
      include_tasks: config/config.yml

    - name: Update APT cache
      ansible.builtin.apt:
        update_cache: true
        cache_valid_time: 3600
        lock_timeout: "{{ apt_lock_timeout }}"
      changed_when: false
      become: true

  roles:
    - role: bootstrap
    - role: update
    - role: base_system
    - role: packages
    - role: dev_tools
      vars:
        install_jetbrains_toolbox: "{{ install_jetbrains_toolbox }}"
        install_vscode: "{{ install_vscode }}"
    - role: green_leader.codium
      become: true
      when: install_vscodium
    - role: pyenv
